<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Properties</title>
    
    <!-- Firebase CDN -->
    <script type="module">
        // Import the functions you need from the SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-analytics.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-storage.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBFcaYolaeuZ5QRUt5qS9gTFf4GW-LYIZY",
            authDomain: "legacy-genuine-properties.firebaseapp.com",
            databaseURL: "https://legacy-genuine-properties-default-rtdb.firebaseio.com",
            projectId: "legacy-genuine-properties",
            storageBucket: "legacy-genuine-properties.appspot.com",
            messagingSenderId: "795578734998",
            appId: "1:795578734998:web:5a06078443af3bec4ee5b7",
            measurementId: "G-RRZ7M9TW8T"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const storage = getStorage(app);

        // Function to upload the image
        function uploadProperty() {
            const file = document.getElementById('propertyImage').files[0]; // Get file from input
            const propertyName = document.getElementById('propertyName').value;
            const propertyDescription = document.getElementById('propertyDescription').value;

            if (file && propertyName && propertyDescription) {
                // Create a reference in Firebase Storage
                const storageRef = ref(storage, 'property-images/' + file.name);

                // Upload the file to Firebase Storage
                const uploadTask = uploadBytesResumable(storageRef, file);

                // Monitor the progress of the upload
                uploadTask.on('state_changed', 
                    (snapshot) => {
                        // Progress indicator
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        console.log('Upload is ' + progress + '% done');
                    }, 
                    (error) => {
                        console.error('Upload failed:', error);
                    }, 
                    () => {
                        // Get the download URL when the upload completes
                        getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {
                            console.log('File available at', downloadURL);
                            alert('Property uploaded successfully!');
                        });
                    }
                );
            } else {
                alert('Please fill out all the fields and select an image');
            }
        }
    </script>
</head>
<body>

    <h2>Upload a New Property</h2>

    <!-- Form for uploading property details -->
    <form onsubmit="event.preventDefault(); uploadProperty();">
        <label for="propertyName">Property Name:</label>
        <input type="text" id="propertyName" placeholder="Enter property name" required><br><br>

        <label for="propertyDescription">Property Description:</label>
        <textarea id="propertyDescription" placeholder="Enter property description" required></textarea><br><br>

        <label for="propertyImage">Property Image:</label>
        <input type="file" id="propertyImage" accept="image/*" required><br><br>

        <button type="submit">Upload Property</button>
    </form>

</body>
</html>
